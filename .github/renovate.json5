{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    "config:recommended",
    "docker:enableMajor",
    ":dependencyDashboard",
    ":disableRateLimiting",
    ":timezone(America/New_York)",
    ":semanticCommits"
  ],
  "dependencyDashboardTitle": "Renovate Dashboard ðŸ¤–",
  "suppressNotifications": [
    "prEditedNotification",
    "prIgnoreNotification"
  ],
  "regexManagers": [
    {
      "fileMatch": ["(^|/)/Dockerfile$"],
      "matchStrings": [
        "ARG\\s+(\\w+)_VERSION=(?<currentValue>.*?)\\n"
      ],
      "datasourceTemplate": "docker",
      "depNameTemplate": "{{argName}}",
      "versioningTemplate": "docker"
    }
  ],
  "packageRules": [
    {
      "addLabels": [
        "renovate/container",
        "type/major"
      ],
      "additionalBranchPrefix": "{{parentDir}}-",
      "commitMessageExtra": " ( {{currentVersion}} â†’ {{newVersion}} )",
      "commitMessagePrefix": "feat({{parentDir}})!: ",
      "commitMessageTopic": "{{depName}}",
      "labels": [
        "app/{{parentDir}}"
      ],
      "matchDatasources": [
        "docker",
        "github-release-attachments"
      ],
      "matchFileNames": [
        "apps/**/Dockerfile"
      ],
      "matchUpdateTypes": [
        "major"
      ]
    },
    {
      "addLabels": [
        "renovate/container",
        "type/minor"
      ],
      "additionalBranchPrefix": "{{parentDir}}-",
      "commitMessageExtra": "( {{currentVersion}} â†’ {{newVersion}} )",
      "commitMessageTopic": "{{depName}}",
      "labels": [
        "app/{{parentDir}}"
      ],
      "matchDatasources": [
        "docker",
        "github-release-attachments"
      ],
      "matchFileNames": [
        "apps/**/Dockerfile"
      ],
      "matchUpdateTypes": [
        "minor"
      ],
      "semanticCommitScope": "{{parentDir}}",
      "semanticCommitType": "feat"
    },
    {
      "addLabels": [
        "renovate/container",
        "type/patch"
      ],
      "additionalBranchPrefix": "{{parentDir}}-",
      "commitMessageExtra": "( {{currentVersion}} â†’ {{newVersion}} )",
      "commitMessageTopic": "{{depName}}",
      "labels": [
        "app/{{parentDir}}"
      ],
      "matchDatasources": [
        "docker",
        "github-release-attachments"
      ],
      "matchFileNames": [
        "apps/**/Dockerfile"
      ],
      "matchUpdateTypes": [
        "patch"
      ],
      "semanticCommitScope": "{{parentDir}}",
      "semanticCommitType": "fix"
    }
  ],
  "customManagers": [
    {
      "customType": "regex",
      "description": ["Process custom dependencies"],
      "fileMatch": ["(^|/)/Dockerfile$"],
      "matchStrings": [
        "datasource=(?<datasource>\\S+) depName=(?<depName>\\S+)( repository=(?<registryUrl>\\S+))?\\n.+: (&\\S+\\s)?(?<currentValue>\\S+)",
        "datasource=(?<datasource>\\S+) depName=(?<depName>\\S+)\\n.+/(?<currentValue>(v|\\d)[^/]+)"
      ],
      "datasourceTemplate": "{{#if datasource}}{{{datasource}}}{{else}}github-releases{{/if}}"
    },
    {
      "customType": "regex",
      "description": ["Process CloudnativePG Postgresql version"],
      "fileMatch": [
        "(^|/)kubernetes/.+\\.ya?ml(?:\\.j2)?$"
      ],
      "matchStrings": [
        "imageName: (?<depName>\\S+):(?<currentValue>.*\\-.*)"
      ],
      "datasourceTemplate": "docker",
      "versioningTemplate": "redhat"
    }
  ]
}
